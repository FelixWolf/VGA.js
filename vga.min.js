/*(C) 2016 FÃ©lix Wolf - MIT Licensed*/
var VGARenderer=function(){var g={font:"/VGA.font",font_data:[]},h=document.currentScript,c=function(b){var d=this;this.COLOR=this.COLOUR={BLACK:[0,0,0],RED:[170,0,0],GREEN:[0,170,0],BROWN:[170,85,0],BLUE:[0,0,170],MAGENTA:[170,0,170],CYAN:[0,170,170],GREY:[170,170,170],LIGHT_DARKGRAY:[85,85,85],LIGHT_RED:[255,85,85],LIGHT_GREEN:[85,255,85],LIGHT_YELLOW:[255,255,85],LIGHT_BLUE:[85,85,255],LIGHT_MAGENTA:[255,85,255],LIGHT_CYAN:[85,255,255],LIGHT_WHITE:[255,255,255]};this.__LOCAL__={cursor:{x:0,y:0,
"char":"\x00",image:null},colour:{foreground:this.COLOUR.GREY,background:this.COLOUR.BLACK}};this.__LOCAL__.canvas=b;this.__LOCAL__.canvas.width=640;this.__LOCAL__.canvas.height=400;this.__LOCAL__.ctx=this.__LOCAL__.canvas.getContext("2d");this.__LOCAL__.ctx.beginPath();this.__LOCAL__.ctx.rect(0,0,640,400);this.__LOCAL__.ctx.fillStyle=this.COLOUR.BLACK;this.__LOCAL__.ctx.fill();this.__LOCAL__.cursor.image=this.__LOCAL__.ctx.createImageData(8,16);this.__LOCAL__.cursor.buffer=this.__LOCAL__.cursor.image.data;
this.__LOCAL__.screen=this.__LOCAL__.ctx.createImageData(640,400);this.__LOCAL__.screen_buffer=this.__LOCAL__.screen.data;this.__LOCAL__.loaded=function(){d.onload();d.ready=!0};this.onload=function(){};this.ready=!1;this.__CONFIG__=""==h.innerHTML?{}:JSON.parse(h.innerHTML);for(var a in g)"undefined"==typeof this.__CONFIG__[a]&&(this.__CONFIG__[a]=g[a]);this.loadFont=function(a){var e=new XMLHttpRequest;e.open("GET",a,!0);e.responseType="arraybuffer";e.onload=function(){var a=e.response;if(a)for(var a=
new Uint8Array(a),b=0;b<a.byteLength;b+=16){for(var c=[],f=0;16>f;f++)c.push(a[b+f]);d.__CONFIG__.font_data.push(c)}d.__LOCAL__.loaded()};e.send(null)};this.loadFont(this.__CONFIG__.font)};c.prototype.setCursor=function(b,d){if("number"!=typeof b||"number"!=typeof d)throw new TypeError("Non-numeric value passed as position");this.__LOCAL__.cursor.x=b;this.__LOCAL__.cursor.y=d};c.prototype.getCursor=function(){return{x:this.__LOCAL__.cursor.x,y:this.__LOCAL__.cursor.y}};c.prototype.setBitmap=function(b){for(var d=
0,a=0;512>d;d+=4,a++)0!=(128>>a%8&b[Math.floor(a/8)])?(this.__LOCAL__.cursor.buffer[d]=this.__LOCAL__.colour.foreground[0],this.__LOCAL__.cursor.buffer[d+1]=this.__LOCAL__.colour.foreground[1],this.__LOCAL__.cursor.buffer[d+2]=this.__LOCAL__.colour.foreground[2]):(this.__LOCAL__.cursor.buffer[d]=this.__LOCAL__.colour.background[0],this.__LOCAL__.cursor.buffer[d+1]=this.__LOCAL__.colour.background[1],this.__LOCAL__.cursor.buffer[d+2]=this.__LOCAL__.colour.background[2]),this.__LOCAL__.cursor.buffer[d+
3]=255};c.prototype.setChar=function(b){this.__LOCAL__.cursor["char"]=b.charCodeAt(0);this.setBitmap(this.__CONFIG__.font_data[this.__LOCAL__.cursor["char"]])};c.prototype.draw=function(){this.__LOCAL__.ctx.putImageData(this.__LOCAL__.cursor.image,8*this.__LOCAL__.cursor.x-8,16*this.__LOCAL__.cursor.y)};c.prototype.write=function(b){for(var d=0;d<b.length;d++){var a=b.charAt(d);"\n"==a?25<++this.__LOCAL__.cursor.y&&(this.push(1),this.__LOCAL__.cursor.y=24):"\r"==a?this.__LOCAL__.cursor.x=0:(this.setChar(a),
80<++this.__LOCAL__.cursor.x&&(this.__LOCAL__.cursor.x=0,25<++this.__LOCAL__.cursor.y&&(this.push(1),this.__LOCAL__.cursor.y=24)),this.draw())}};c.prototype.setForegroundColour=c.prototype.setForegroundColor=function(b){this.__LOCAL__.colour.foreground=b};c.prototype.getForegroundColour=c.prototype.getForegroundColor=function(b){return this.__LOCAL__.colour.foreground};c.prototype.setBackgroundColour=c.prototype.setBackgroundColor=function(b){this.__LOCAL__.colour.background=b};c.prototype.getBackgroundColour=
c.prototype.getBackgroundColor=function(b){return this.__LOCAL__.colour.background};c.prototype.clear=function(){this.__LOCAL__.ctx.beginPath();this.__LOCAL__.ctx.rect(0,0,640,400);this.__LOCAL__.ctx.fillStyle="rgb("+this.__LOCAL__.colour.background.join()+")";this.__LOCAL__.ctx.fill()};c.prototype.clearLine=function(b){this.__LOCAL__.ctx.beginPath();this.__LOCAL__.ctx.rect(16*b,0,640,16);this.__LOCAL__.ctx.fillStyle="rgb("+this.__LOCAL__.colour.background.join()+")";this.__LOCAL__.ctx.fill()};c.prototype.clearRow=
function(b){this.__LOCAL__.ctx.beginPath();this.__LOCAL__.ctx.rect(0,8*b,0,400);this.__LOCAL__.ctx.fillStyle="rgb("+this.__LOCAL__.colour.background.join()+")";this.__LOCAL__.ctx.fill()};c.prototype.push=function(b){for(var d=this.__LOCAL__.ctx.getImageData(0,0,640,400),a=d.data,c=0;c<b;c++){for(var e=0;983040>e;e+=4)a[e]=a[e+40960],a[e+1]=a[e+40961],a[e+2]=a[e+40962],a[e+3]=a[e+40963];for(e=983040;1024E3>e;e+=4)a[e]=a[0],a[e+1]=a[1],a[e+2]=a[2],a[e+3]=255}this.__LOCAL__.ctx.putImageData(d,0,0)};
c.prototype.reset=function(){this.__LOCAL__.colour.foreground=this.COLOUR.GREY;this.__LOCAL__.colour.background=this.COLOUR.BLACK;this.__LOCAL__.cursor.x=0;this.__LOCAL__.cursor.y=0};return c}();
